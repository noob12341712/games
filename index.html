<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>GAME HUB â€” ARCADE</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&family=VT323:wght@400&display=swap');

    :root {
      --bg: #0a0a0f;
      --bg2: #0f0f1a;
      --pixel-green: #00ff41;
      --pixel-yellow: #ffe600;
      --pixel-red: #ff003c;
      --pixel-blue: #00cfff;
      --pixel-purple: #c800ff;
      --pixel-orange: #ff8800;
      --card-bg: #12121f;
      --border: #2a2a4a;
      --scanline: rgba(0,0,0,0.18);
    }

    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      background: var(--bg);
      color: #eee;
      font-family: 'Press Start 2P', monospace;
      min-height: 100vh;
      overflow-x: hidden;
      cursor: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16'%3E%3Crect x='0' y='0' width='8' height='8' fill='%2300ff41'/%3E%3Crect x='8' y='8' width='8' height='8' fill='%2300ff41'/%3E%3C/svg%3E") 8 8, crosshair;
    }

    /* CRT scanlines overlay */
    body::before {
      content: '';
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: repeating-linear-gradient(
        0deg,
        var(--scanline) 0px,
        var(--scanline) 1px,
        transparent 1px,
        transparent 3px
      );
      pointer-events: none;
      z-index: 9999;
    }

    /* Pixel grid background */
    body::after {
      content: '';
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background-image:
        linear-gradient(rgba(0,255,65,0.03) 1px, transparent 1px),
        linear-gradient(90deg, rgba(0,255,65,0.03) 1px, transparent 1px);
      background-size: 32px 32px;
      pointer-events: none;
      z-index: 0;
    }

    /* ========== HEADER ========== */
    header {
      position: relative;
      z-index: 10;
      text-align: center;
      padding: 50px 20px 30px;
      background: linear-gradient(180deg, #000 0%, transparent 100%);
      border-bottom: 4px solid var(--pixel-green);
      image-rendering: pixelated;
    }

    .header-insert {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 20px;
      margin-bottom: 12px;
    }

    .pixel-coin {
      width: 24px; height: 24px;
      background: var(--pixel-yellow);
      border-radius: 0;
      box-shadow:
        4px 0 0 var(--pixel-yellow),
        -4px 0 0 var(--pixel-yellow),
        0 4px 0 var(--pixel-orange),
        0 -4px 0 #fff8a0;
      animation: coinSpin 1s steps(4) infinite;
      flex-shrink: 0;
    }

    @keyframes coinSpin {
      0%   { transform: scaleX(1); background: var(--pixel-yellow); }
      25%  { transform: scaleX(0.5); background: var(--pixel-orange); }
      50%  { transform: scaleX(0.1); background: #333; }
      75%  { transform: scaleX(0.5); background: var(--pixel-orange); }
      100% { transform: scaleX(1); background: var(--pixel-yellow); }
    }

    h1 {
      font-size: clamp(1.4rem, 4vw, 2.6rem);
      letter-spacing: 4px;
      color: var(--pixel-green);
      text-shadow:
        4px 4px 0 #003a10,
        0 0 30px rgba(0,255,65,0.5),
        0 0 60px rgba(0,255,65,0.2);
      animation: flicker 4s steps(1) infinite;
    }

    @keyframes flicker {
      0%, 95%, 100% { opacity: 1; }
      96% { opacity: 0.7; }
      97% { opacity: 1; }
      98% { opacity: 0.5; }
    }

    .subtitle {
      font-family: 'VT323', monospace;
      font-size: 1.4rem;
      color: var(--pixel-yellow);
      margin-top: 10px;
      letter-spacing: 3px;
      text-shadow: 2px 2px 0 #665900;
    }

    .insert-coin {
      font-family: 'VT323', monospace;
      font-size: 1.6rem;
      color: var(--pixel-red);
      margin-top: 14px;
      animation: blink 1s steps(1) infinite;
      letter-spacing: 3px;
    }
    @keyframes blink { 0%, 49% { opacity: 1; } 50%, 100% { opacity: 0; } }

    /* ========== LIVES BAR ========== */
    .lives-bar {
      position: relative;
      z-index: 10;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 30px;
      background: #050510;
      border-bottom: 2px solid var(--border);
      font-family: 'VT323', monospace;
      font-size: 1.2rem;
    }
    .lives-bar span { color: var(--pixel-green); }
    .lives-bar .score-val { color: var(--pixel-yellow); font-size: 1.4rem; }
    .hearts { color: var(--pixel-red); letter-spacing: 4px; }

    /* ========== GRID ========== */
    .container {
      position: relative;
      z-index: 10;
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
      gap: 30px;
      padding: 40px 30px;
      max-width: 1400px;
      margin: 0 auto;
    }

    /* ========== GAME CARD ========== */
    .game-card {
      background: var(--card-bg);
      border: 3px solid var(--border);
      position: relative;
      overflow: hidden;
      transition: transform 0.1s steps(2), border-color 0.15s;
      image-rendering: pixelated;
    }

    .game-card::before {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, rgba(255,255,255,0.03) 0%, transparent 60%);
      pointer-events: none;
      z-index: 1;
    }

    /* Pixel-art corner decorations */
    .game-card::after {
      content: '';
      position: absolute;
      top: -2px; left: -2px;
      width: 12px; height: 12px;
      background: var(--accent);
      z-index: 5;
      box-shadow: calc(100% + 4px - 12px) 0 0 var(--accent), 0 calc(100% + 4px - 12px) 0 var(--accent), calc(100% + 4px - 12px) calc(100% + 4px - 12px) 0 var(--accent);
      pointer-events: none;
    }

    .game-card:hover {
      transform: translate(-4px, -4px);
      border-color: var(--accent);
      box-shadow: 8px 8px 0 var(--accent-shadow);
    }

    .game-card:hover .preview-canvas { opacity: 1; animation-play-state: running; }
    .game-card:hover .card-overlay { opacity: 1; }

    /* Card accent colors */
    .card-sandboxels  { --accent: #00ff41; --accent-shadow: #003a10; }
    .card-eaglercraft { --accent: #00cfff; --accent-shadow: #003a4a; }
    .card-geodash     { --accent: #ff8800; --accent-shadow: #4a2000; }
    .card-mario       { --accent: #ff003c; --accent-shadow: #4a000f; }
    .card-pacman      { --accent: #ffe600; --accent-shadow: #4a3a00; }
    .card-drivemad    { --accent: #c800ff; --accent-shadow: #350044; }

    /* ---- Preview Area ---- */
    .preview-area {
      width: 100%;
      height: 200px;
      background: #000;
      position: relative;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    canvas.preview-canvas {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      opacity: 0.85;
      image-rendering: pixelated;
      transition: opacity 0.2s;
    }

    .card-overlay {
      position: absolute;
      inset: 0;
      background: rgba(0,0,0,0.2);
      opacity: 0;
      transition: opacity 0.2s;
      z-index: 3;
    }

    /* ---- Card Body ---- */
    .card-body {
      padding: 20px;
      position: relative;
      z-index: 2;
    }

    .card-title {
      font-size: 0.9rem;
      color: var(--accent);
      text-shadow: 2px 2px 0 var(--accent-shadow);
      margin-bottom: 10px;
      letter-spacing: 2px;
    }

    .card-desc {
      font-family: 'VT323', monospace;
      font-size: 1.1rem;
      color: #aab;
      line-height: 1.5;
      margin-bottom: 20px;
      min-height: 50px;
    }

    .card-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 20px;
    }

    .tag {
      font-family: 'VT323', monospace;
      font-size: 1rem;
      padding: 3px 8px;
      border: 2px solid var(--accent);
      color: var(--accent);
      background: rgba(0,0,0,0.4);
      letter-spacing: 1px;
    }

    .launch-btn {
      display: block;
      width: 100%;
      padding: 14px;
      background: var(--accent);
      color: #000;
      font-family: 'Press Start 2P', monospace;
      font-size: 0.7rem;
      text-align: center;
      text-decoration: none;
      letter-spacing: 2px;
      border: none;
      position: relative;
      overflow: hidden;
      transition: filter 0.1s;
      image-rendering: pixelated;
    }

    .launch-btn::before {
      content: 'â–¶ ';
    }

    .launch-btn:hover {
      filter: brightness(1.2);
    }

    .launch-btn:active {
      transform: translate(2px, 2px);
      box-shadow: none;
    }

    /* pixel border bottom on button */
    .launch-btn-wrap {
      position: relative;
    }
    .launch-btn-wrap::after {
      content: '';
      display: block;
      height: 4px;
      background: var(--accent-shadow);
    }

    /* ========== FOOTER ========== */
    footer {
      position: relative;
      z-index: 10;
      text-align: center;
      padding: 30px;
      font-family: 'VT323', monospace;
      font-size: 1.2rem;
      color: #555;
      border-top: 3px solid var(--border);
      background: #050510;
    }
    footer a { color: var(--pixel-green); text-decoration: none; }
    footer a:hover { color: var(--pixel-yellow); }

    .footer-sprite {
      display: inline-block;
      margin-bottom: 10px;
      font-size: 1.6rem;
      animation: walkSprite 0.6s steps(2) infinite;
    }
    @keyframes walkSprite {
      0%   { transform: translateY(0); }
      50%  { transform: translateY(-4px); }
      100% { transform: translateY(0); }
    }

    /* ========== PIXEL ART CANVASES ========== */
    /* Drawn via JS below */
  </style>
</head>
<body>

  <header>
    <div class="header-insert">
      <div class="pixel-coin"></div>
      <h1>â—€ GAME HUB â–¶</h1>
      <div class="pixel-coin"></div>
    </div>
    <p class="subtitle">SELECT YOUR GAME â€” PRESS START</p>
    <p class="insert-coin">â€” INSERT COIN â€”</p>
  </header>

  <div class="lives-bar">
    <span>SCORE: <span class="score-val" id="score">000000</span></span>
    <span class="hearts">â™¥ â™¥ â™¥</span>
    <span>HI-SCORE: <span class="score-val">999999</span></span>
  </div>

  <div class="container">

    <!-- SANDBOXELS -->
    <div class="game-card card-sandboxels">
      <div class="preview-area">
        <canvas class="preview-canvas" id="cvs-sandboxels" width="340" height="200"></canvas>
        <div class="card-overlay"></div>
      </div>
      <div class="card-body">
        <h2 class="card-title">SANDBOXELS</h2>
        <p class="card-desc">Falling-sand simulation. Mix elements, ignite reactions, watch chaos unfold!</p>
        <div class="card-tags">
          <span class="tag">SANDBOX</span>
          <span class="tag">PHYSICS</span>
          <span class="tag">1P</span>
        </div>
        <div class="launch-btn-wrap">
          <a href="sandboxels.html" target="_blank" rel="noopener noreferrer" class="launch-btn">LAUNCH GAME</a>
        </div>
      </div>
    </div>

    <!-- EAGLERCRAFT -->
    <div class="game-card card-eaglercraft">
      <div class="preview-area">
        <canvas class="preview-canvas" id="cvs-eaglercraft" width="340" height="200"></canvas>
        <div class="card-overlay"></div>
      </div>
      <div class="card-body">
        <h2 class="card-title">EAGLERCRAFT</h2>
        <p class="card-desc">Browser Minecraft â€” build, mine, survive in a blocky infinite world!</p>
        <div class="card-tags">
          <span class="tag">SURVIVAL</span>
          <span class="tag">OPEN WORLD</span>
          <span class="tag">MP</span>
        </div>
        <div class="launch-btn-wrap">
          <a href="eaglercraft-offline.html" target="_blank" rel="noopener noreferrer" class="launch-btn">LAUNCH GAME</a>
        </div>
      </div>
    </div>

    <!-- GEOMETRY DASH -->
    <div class="game-card card-geodash">
      <div class="preview-area">
        <canvas class="preview-canvas" id="cvs-geodash" width="340" height="200"></canvas>
        <div class="card-overlay"></div>
      </div>
      <div class="card-body">
        <h2 class="card-title">GEOMETRY DASH</h2>
        <p class="card-desc">Rhythm-based platformer. Jump, fly and flip your way through danger!</p>
        <div class="card-tags">
          <span class="tag">RHYTHM</span>
          <span class="tag">PRECISION</span>
          <span class="tag">1P</span>
        </div>
        <div class="launch-btn-wrap">
          <a href="geometry-dash-offline.html" target="_blank" rel="noopener noreferrer" class="launch-btn">LAUNCH GAME</a>
        </div>
      </div>
    </div>

    <!-- MARIO -->
    <div class="game-card card-mario">
      <div class="preview-area">
        <canvas class="preview-canvas" id="cvs-mario" width="340" height="200"></canvas>
        <div class="card-overlay"></div>
      </div>
      <div class="card-body">
        <h2 class="card-title">MARIO</h2>
        <p class="card-desc">The legendary plumber returns! Run, jump and stomp your way to glory!</p>
        <div class="card-tags">
          <span class="tag">PLATFORMER</span>
          <span class="tag">CLASSIC</span>
          <span class="tag">1P</span>
        </div>
        <div class="launch-btn-wrap">
          <a href="mario.html" target="_blank" rel="noopener noreferrer" class="launch-btn">LAUNCH GAME</a>
        </div>
      </div>
    </div>

    <!-- PAC-MAN -->
    <div class="game-card card-pacman">
      <div class="preview-area">
        <canvas class="preview-canvas" id="cvs-pacman" width="340" height="200"></canvas>
        <div class="card-overlay"></div>
      </div>
      <div class="card-body">
        <h2 class="card-title">PAC-MAN</h2>
        <p class="card-desc">Chomp dots, avoid ghosts and eat power pellets in this arcade legend!</p>
        <div class="card-tags">
          <span class="tag">ARCADE</span>
          <span class="tag">MAZE</span>
          <span class="tag">1P</span>
        </div>
        <div class="launch-btn-wrap">
          <a href="pacman.html" target="_blank" rel="noopener noreferrer" class="launch-btn">LAUNCH GAME</a>
        </div>
      </div>
    </div>

    <!-- DRIVE MAD -->
    <div class="game-card card-drivemad">
      <div class="preview-area">
        <canvas class="preview-canvas" id="cvs-drivemad" width="340" height="200"></canvas>
        <div class="card-overlay"></div>
      </div>
      <div class="card-body">
        <h2 class="card-title">DRIVE MAD</h2>
        <p class="card-desc">Crazy physics driving! Keep your wheels on the road without flipping!</p>
        <div class="card-tags">
          <span class="tag">RACING</span>
          <span class="tag">PHYSICS</span>
          <span class="tag">1P</span>
        </div>
        <div class="launch-btn-wrap">
          <a href="drive-mad.html" target="_blank" rel="noopener noreferrer" class="launch-btn">LAUNCH GAME</a>
        </div>
      </div>
    </div>

  </div>

  <footer>
    <div class="footer-sprite">ðŸ‘¾</div><br>
    GAME HUB Â© 2025 â€” ALL RIGHTS RESERVED<br><br>
    <a href="https://www.youtube.com/watch?v=dQw4w9WgXcQ" target="_blank" rel="noopener noreferrer">BUY ME A COFFEE â˜•</a>
  </footer>

<script>
// =====================================================
// PIXEL ART ANIMATED PREVIEWS
// =====================================================

// Score ticker
let score = 0;
setInterval(() => {
  score += Math.floor(Math.random() * 150);
  if (score > 999999) score = 0;
  document.getElementById('score').textContent = String(score).padStart(6, '0');
}, 200);

// --- HELPERS ---
function px(ctx, x, y, w, h, color) {
  ctx.fillStyle = color;
  ctx.fillRect(x * w, y * h, w, h);
}

// =====================================================
// SANDBOXELS: falling sand simulation preview
// =====================================================
(function() {
  const c = document.getElementById('cvs-sandboxels');
  const ctx = c.getContext('2d');
  const W = 68, H = 40, PW = c.width/W, PH = c.height/H;
  const grid = Array.from({length: H}, () => new Array(W).fill(null));
  const colors = {
    sand: '#e8c84a', water: '#1a90ff', fire: '#ff4400',
    smoke: '#888', stone: '#777', empty: null, lava: '#ff6600', dirt: '#8b5e3c'
  };

  function addParticle(x, y, type) {
    if (x >= 0 && x < W && y >= 0 && y < H) grid[y][x] = type;
  }

  // Pre-fill some stone ground
  for (let x = 0; x < W; x++) {
    for (let y = H-4; y < H; y++) grid[y][x] = 'stone';
    grid[H-5][x] = 'dirt';
  }

  let t = 0;
  function step() {
    t++;
    // Spawn particles
    if (t % 3 === 0) { addParticle(Math.floor(W*0.3) + Math.floor(Math.random()*3)-1, 0, 'sand'); }
    if (t % 5 === 0) { addParticle(Math.floor(W*0.6), 0, 'water'); }
    if (t % 20 === 0) { addParticle(Math.floor(W*0.15) + Math.floor(Math.random()*3)-1, 2, 'fire'); }

    // Simple physics (bottom-up)
    for (let y = H-2; y >= 0; y--) {
      for (let x = 0; x < W; x++) {
        const cell = grid[y][x];
        if (!cell) continue;

        if (cell === 'sand' || cell === 'dirt') {
          if (y+1 < H && !grid[y+1][x]) { grid[y+1][x] = cell; grid[y][x] = null; }
          else if (y+1 < H && x-1 >= 0 && !grid[y+1][x-1]) { grid[y+1][x-1] = cell; grid[y][x] = null; }
          else if (y+1 < H && x+1 < W && !grid[y+1][x+1]) { grid[y+1][x+1] = cell; grid[y][x] = null; }
        } else if (cell === 'water') {
          if (y+1 < H && !grid[y+1][x]) { grid[y+1][x] = 'water'; grid[y][x] = null; }
          else {
            const dir = Math.random() < 0.5 ? -1 : 1;
            if (x+dir >= 0 && x+dir < W && !grid[y][x+dir]) { grid[y][x+dir] = 'water'; grid[y][x] = null; }
          }
        } else if (cell === 'fire') {
          // spread upward / disappear
          if (Math.random() < 0.05) { grid[y][x] = null; }
          else if (y-1 >= 0 && Math.random() < 0.3 && !grid[y-1][x]) { grid[y-1][x] = 'fire'; }
          else if (Math.random() < 0.1) { if (y-1 >= 0) grid[y-1][x] = 'smoke'; grid[y][x] = null; }
          // fire + sand = lava
          if (y+1 < H && grid[y+1][x] === 'sand') { grid[y+1][x] = 'lava'; }
        } else if (cell === 'smoke') {
          if (y-1 >= 0 && !grid[y-1][x]) { grid[y-1][x] = 'smoke'; grid[y][x] = null; }
          else if (Math.random() < 0.15) grid[y][x] = null;
        } else if (cell === 'lava') {
          if (y+1 < H && !grid[y+1][x] && grid[y+1][x] !== 'stone') { grid[y+1][x] = 'lava'; grid[y][x] = null; }
          if (Math.random() < 0.005) { grid[y][x] = 'stone'; }
        }
      }
    }

    // Draw
    ctx.fillStyle = '#0a0a0f';
    ctx.fillRect(0, 0, c.width, c.height);
    for (let y = 0; y < H; y++) {
      for (let x = 0; x < W; x++) {
        const cell = grid[y][x];
        if (!cell) continue;
        let col = colors[cell] || '#fff';
        if (cell === 'fire') { const r = Math.random(); col = r < 0.33 ? '#ff2200' : r < 0.66 ? '#ff6600' : '#ffaa00'; }
        if (cell === 'smoke') { const v = Math.floor(Math.random()*60+80).toString(16); col = `#${v}${v}${v}`; }
        ctx.fillStyle = col;
        ctx.fillRect(x * PW, y * PH, PW, PH);
      }
    }
    requestAnimationFrame(step);
  }
  step();
})();

// =====================================================
// EAGLERCRAFT: Minecraft-style block preview
// =====================================================
(function() {
  const c = document.getElementById('cvs-eaglercraft');
  const ctx = c.getContext('2d');
  const S = 20; // block size in pixels
  const W = Math.ceil(c.width / S), H = Math.ceil(c.height / S);
  let t = 0;

  // Terrain heights
  const terrain = [];
  for (let x = 0; x < W; x++) {
    terrain[x] = Math.floor(H * 0.5 + Math.sin(x * 0.5) * 2 + Math.cos(x * 0.3) * 1.5);
  }

  const clouds = [{x: 2, y: 1}, {x: 8, y: 2}, {x: 14, y: 1}];
  const playerX = 5;

  const GRASS   = '#5a9e3a';
  const GRASS_D = '#3a7020';
  const DIRT    = '#8b5e2a';
  const STONE   = '#6a6a7a';
  const SKY_TOP = '#1a3c7a';
  const SKY_BOT = '#2a60c0';
  const SUN     = '#ffe640';
  const CLOUD   = '#ccddff';
  const WOOD    = '#6b4a1e';
  const LEAF    = '#2d8a20';
  const WATER   = '#1a60cc';

  function drawBlock(bx, by, top, side, bottom) {
    const x = bx * S, y = by * S;
    // Top face
    ctx.fillStyle = top;
    ctx.fillRect(x + 2, y, S - 4, 4);
    // Main face
    ctx.fillStyle = side;
    ctx.fillRect(x, y + 4, S, S - 4);
    // Shadow edge
    ctx.fillStyle = bottom;
    ctx.fillRect(x, y + S - 3, S, 3);
    ctx.fillRect(x + S - 3, y + 4, 3, S - 7);
  }

  function frame() {
    t++;

    // Sky gradient
    const grad = ctx.createLinearGradient(0, 0, 0, c.height);
    grad.addColorStop(0, SKY_TOP);
    grad.addColorStop(1, SKY_BOT);
    ctx.fillStyle = grad;
    ctx.fillRect(0, 0, c.width, c.height);

    // Sun
    const sunX = ((t * 0.3) % (c.width + 60)) - 30;
    ctx.fillStyle = SUN;
    ctx.fillRect(sunX, 15, 24, 24);
    ctx.fillStyle = 'rgba(255,230,64,0.3)';
    ctx.fillRect(sunX - 6, 9, 36, 36);

    // Clouds scroll
    ctx.fillStyle = CLOUD;
    clouds.forEach(cl => {
      cl.x -= 0.015;
      if (cl.x < -3) cl.x = W + 2;
      const cx = cl.x * S, cy = cl.y * S;
      ctx.fillRect(cx, cy + S*0.5, S*3, S*0.7);
      ctx.fillRect(cx + S*0.5, cy, S*2, S*0.7);
    });

    // Terrain
    for (let x = 0; x < W; x++) {
      const h = terrain[x];
      // Grass block
      drawBlock(x, h, GRASS, GRASS_D, '#264a12');
      // Dirt
      for (let y = h + 1; y < h + 3; y++) drawBlock(x, y, DIRT, '#6e4a20', '#4a3010');
      // Stone
      for (let y = h + 3; y < H; y++) drawBlock(x, y, STONE, '#5a5a6a', '#3a3a4a');
      // Water in valleys
      if (h >= Math.floor(H * 0.6)) {
        ctx.fillStyle = `rgba(26,96,200,0.6)`;
        ctx.fillRect(x * S, h * S, S, S);
      }
    }

    // Tree
    const tx = 10, ty = terrain[tx] - 1;
    drawBlock(tx, ty, WOOD, '#5a3a10', '#3a2008');
    drawBlock(tx, ty - 1, WOOD, '#5a3a10', '#3a2008');
    drawBlock(tx, ty - 2, WOOD, '#5a3a10', '#3a2008');
    // Leaves
    for (let lx = tx-1; lx <= tx+1; lx++) {
      drawBlock(lx, ty - 3, LEAF, '#267a18', '#164a0a');
      if (lx === tx) drawBlock(lx, ty - 4, LEAF, '#267a18', '#164a0a');
    }

    // Player (Steve)
    const py = terrain[playerX] - 1;
    // Body
    ctx.fillStyle = '#4a9acc'; ctx.fillRect(playerX*S+4, py*S+6, 12, 10);
    // Head
    ctx.fillStyle = '#d4a07a'; ctx.fillRect(playerX*S+4, py*S-4, 12, 10);
    // Eyes
    ctx.fillStyle = '#222';
    ctx.fillRect(playerX*S+6, py*S-1, 2, 2);
    ctx.fillRect(playerX*S+12, py*S-1, 2, 2);
    // Legs (walk cycle)
    const legOff = Math.sin(t * 0.15) * 3;
    ctx.fillStyle = '#2255aa';
    ctx.fillRect(playerX*S+4, py*S+16, 5, 8 + legOff);
    ctx.fillRect(playerX*S+11, py*S+16, 5, 8 - legOff);

    // Pixel border
    ctx.strokeStyle = 'rgba(0,207,255,0.15)';
    ctx.lineWidth = 2;
    ctx.strokeRect(1, 1, c.width-2, c.height-2);

    requestAnimationFrame(frame);
  }
  frame();
})();

// =====================================================
// GEOMETRY DASH: runner preview
// =====================================================
(function() {
  const c = document.getElementById('cvs-geodash');
  const ctx = c.getContext('2d');
  let t = 0;
  const W = c.width, H = c.height;
  const GROUND = H * 0.72;

  // BG stars
  const stars = Array.from({length: 40}, () => ({
    x: Math.random()*W, y: Math.random()*GROUND*0.8, s: Math.random()*2+1
  }));

  // Obstacles
  const obstacles = [
    {x: W + 60, type:'spike', h:28},
    {x: W + 180, type:'block', h:36},
    {x: W + 300, type:'spike', h:28},
    {x: W + 420, type:'block', h:36},
  ];

  let playerY = GROUND - 36;
  let vy = 0;
  let jumping = false;
  let jumpTimer = 0;

  const CUBE_COLORS = ['#ff8800','#ffaa00','#ff6600'];

  function frame() {
    t++;
    jumpTimer++;

    // Auto-jump rhythm
    if (jumpTimer % 80 === 0) { vy = -12; jumping = true; }
    vy += 0.7;
    playerY += vy;
    if (playerY >= GROUND - 36) { playerY = GROUND - 36; vy = 0; jumping = false; }

    // Scroll obstacles
    obstacles.forEach(ob => {
      ob.x -= 3.5;
      if (ob.x < -60) ob.x = W + Math.random()*150 + 100;
    });

    // BG
    const grad = ctx.createLinearGradient(0, 0, 0, H);
    grad.addColorStop(0, '#0a0020');
    grad.addColorStop(0.7, '#1a0040');
    grad.addColorStop(1, '#0a0010');
    ctx.fillStyle = grad;
    ctx.fillRect(0, 0, W, H);

    // Stars
    ctx.fillStyle = '#fff';
    stars.forEach(s => {
      const flicker = Math.sin(t * 0.05 + s.x) * 0.3 + 0.7;
      ctx.globalAlpha = flicker;
      ctx.fillRect(s.x, s.y, s.s, s.s);
    });
    ctx.globalAlpha = 1;

    // BG lines (speed effect)
    ctx.strokeStyle = 'rgba(255,136,0,0.12)';
    ctx.lineWidth = 1;
    for (let i = 0; i < 8; i++) {
      const lx = ((t * 4 * (i+1)*0.3) % (W + 100)) - 50;
      ctx.beginPath();
      ctx.moveTo(lx, 0);
      ctx.lineTo(lx - 60, H);
      ctx.stroke();
    }

    // Ground
    const gGrad = ctx.createLinearGradient(0, GROUND, 0, H);
    gGrad.addColorStop(0, '#1a0a40');
    gGrad.addColorStop(1, '#0a0520');
    ctx.fillStyle = gGrad;
    ctx.fillRect(0, GROUND, W, H - GROUND);

    // Ground line glow
    ctx.strokeStyle = '#ff8800';
    ctx.lineWidth = 2;
    ctx.shadowColor = '#ff8800';
    ctx.shadowBlur = 8;
    ctx.beginPath();
    ctx.moveTo(0, GROUND); ctx.lineTo(W, GROUND);
    ctx.stroke();
    ctx.shadowBlur = 0;

    // Moving ground tiles
    ctx.fillStyle = 'rgba(255,136,0,0.1)';
    for (let i = 0; i < Math.ceil(W/40)+1; i++) {
      const tx = ((i * 40) - (t*3.5 % 40));
      ctx.fillRect(tx, GROUND, 38, H - GROUND);
      ctx.strokeStyle = 'rgba(255,136,0,0.2)';
      ctx.lineWidth = 1;
      ctx.strokeRect(tx, GROUND, 38, H - GROUND);
    }

    // Obstacles
    obstacles.forEach(ob => {
      if (ob.type === 'spike') {
        ctx.fillStyle = '#ff4400';
        ctx.shadowColor = '#ff4400';
        ctx.shadowBlur = 6;
        ctx.beginPath();
        ctx.moveTo(ob.x, GROUND);
        ctx.lineTo(ob.x + 20, GROUND - ob.h);
        ctx.lineTo(ob.x + 40, GROUND);
        ctx.closePath();
        ctx.fill();
        ctx.shadowBlur = 0;
      } else {
        ctx.fillStyle = '#ff6600';
        ctx.shadowColor = '#ff6600';
        ctx.shadowBlur = 6;
        ctx.fillRect(ob.x, GROUND - ob.h, ob.h, ob.h);
        // Block detail
        ctx.strokeStyle = '#ff9900';
        ctx.lineWidth = 2;
        ctx.strokeRect(ob.x + 2, GROUND - ob.h + 2, ob.h - 4, ob.h - 4);
        ctx.shadowBlur = 0;
      }
    });

    // Player cube
    const px2 = 80, py2 = playerY;
    const rot = (t * 0.08) % (Math.PI * 2);
    ctx.save();
    ctx.translate(px2 + 18, py2 + 18);
    ctx.rotate(jumping ? rot : 0);
    ctx.fillStyle = CUBE_COLORS[Math.floor(t/10) % CUBE_COLORS.length];
    ctx.shadowColor = '#ff8800';
    ctx.shadowBlur = 12;
    ctx.fillRect(-18, -18, 36, 36);
    ctx.strokeStyle = '#ffcc00';
    ctx.lineWidth = 2;
    ctx.strokeRect(-14, -14, 28, 28);
    // X in cube
    ctx.beginPath();
    ctx.moveTo(-10, -10); ctx.lineTo(10, 10);
    ctx.moveTo(10, -10); ctx.lineTo(-10, 10);
    ctx.stroke();
    ctx.shadowBlur = 0;
    ctx.restore();

    requestAnimationFrame(frame);
  }
  frame();
})();

// =====================================================
// MARIO: platformer preview
// =====================================================
(function() {
  const c = document.getElementById('cvs-mario');
  const ctx = c.getContext('2d');
  let t = 0;
  const W = c.width, H = c.height;
  const S = 20; // tile size
  const BLUE = '#5c94fc';
  const GROUND_Y = H - S * 2;

  // Platforms
  const platforms = [
    {x: 200, y: GROUND_Y - 60, w: 80, type:'brick'},
    {x: 340, y: GROUND_Y - 100, w: 60, type:'question'},
    {x: 490, y: GROUND_Y - 60, w: 80, type:'brick'},
  ];

  // Goomba
  let goombaX = 350, goombaDir = -1;

  // Player
  let px = 60, py = GROUND_Y - S*2, pvx = 2.5, pvy = 0;
  let onGround = false, jumpT = 0, facingRight = true;

  // Camera
  let camX = 0;

  // Coins
  const coins = [{x: 350, y: GROUND_Y - 130, collected: false}];

  const BRICK = '#c84800';
  const BRICK_L = '#e86820';
  const QUESTION_BG = '#f8a800';
  const GROUND_TOP = '#58b858';
  const GROUND_FILL = '#a85830';
  const SKY = '#5c94fc';
  const CLOUD_C = '#fffcf0';

  function drawBrickBlock(bx, by, bw) {
    ctx.fillStyle = BRICK;
    ctx.fillRect(bx, by, bw, S);
    ctx.fillStyle = BRICK_L;
    for (let i = 0; i < bw; i += S) {
      ctx.fillRect(bx + i, by, S - 2, 6);
      ctx.fillRect(bx + i + S/2, by + 10, S - 2, 6);
    }
  }
  function drawQuestionBlock(bx, by) {
    const flash = Math.sin(t * 0.1) > 0;
    ctx.fillStyle = flash ? '#ffd000' : QUESTION_BG;
    ctx.fillRect(bx, by, S*3, S);
    ctx.fillStyle = '#c87800';
    ctx.fillRect(bx, by + S - 3, S*3, 3);
    ctx.fillRect(bx, by, S*3, 3);
    ctx.fillRect(bx, by, 3, S);
    ctx.fillRect(bx + S*3 - 3, by, 3, S);
    ctx.fillStyle = '#8b4000';
    ctx.font = 'bold 14px monospace';
    ctx.fillText('?', bx + S*1.1, by + S - 4);
  }
  function drawCloud(cx, cy) {
    ctx.fillStyle = CLOUD_C;
    ctx.fillRect(cx + 10, cy, 40, 20);
    ctx.fillRect(cx, cy + 10, 60, 16);
    ctx.fillRect(cx + 5, cy + 5, 50, 20);
  }
  function drawGoomba(gx, gy) {
    const foot = Math.floor(t/12) % 2;
    ctx.fillStyle = '#8b4500';
    ctx.fillRect(gx, gy + 5, S*1.5, S*1.2);
    // Feet
    ctx.fillStyle = '#5a2800';
    ctx.fillRect(gx + (foot ? 0 : 8), gy + S + 8, 10, 6);
    ctx.fillRect(gx + (foot ? 12 : 4), gy + S + 8, 10, 6);
    // Eyes
    ctx.fillStyle = '#fff';
    ctx.fillRect(gx + 4, gy + 8, 7, 6);
    ctx.fillRect(gx + 16, gy + 8, 7, 6);
    ctx.fillStyle = '#000';
    ctx.fillRect(gx + 6, gy + 10, 3, 4);
    ctx.fillRect(gx + 18, gy + 10, 3, 4);
  }
  function drawMario(mx, my) {
    const leg = Math.floor(t/8) % 2;
    // Hat
    ctx.fillStyle = '#ff2200';
    ctx.fillRect(mx + 4, my - 12, 20, 6);
    ctx.fillRect(mx, my - 6, 28, 6);
    // Hair
    ctx.fillStyle = '#5c3000';
    ctx.fillRect(mx + 2, my, 8, 4);
    // Face
    ctx.fillStyle = '#d4804a';
    ctx.fillRect(mx + 2, my, 24, 16);
    // Eye
    ctx.fillStyle = '#000';
    ctx.fillRect(mx + (facingRight ? 16 : 8), my + 4, 4, 4);
    // Moustache
    ctx.fillStyle = '#5c3000';
    ctx.fillRect(mx + 8, my + 10, 16, 4);
    // Body
    ctx.fillStyle = '#2244cc';
    ctx.fillRect(mx + 2, my + 16, 24, 14);
    // Buttons
    ctx.fillStyle = '#ff2200';
    ctx.fillRect(mx + 8, my + 18, 4, 4);
    ctx.fillRect(mx + 16, my + 18, 4, 4);
    // Legs
    ctx.fillStyle = '#2244cc';
    ctx.fillRect(mx + (leg ? 6 : 2), my + 30, 10, 10);
    ctx.fillRect(mx + (leg ? 14 : 18), my + 30, 10, 10);
    // Boots
    ctx.fillStyle = '#5c3000';
    ctx.fillRect(mx + (leg ? 4 : 0), my + 38, 14, 6);
    ctx.fillRect(mx + (leg ? 14 : 16), my + 38, 14, 6);
  }

  function frame() {
    t++;

    // Player movement
    px += pvx;
    pvy += 0.6;
    py += pvy;
    facingRight = pvx > 0;

    // Ground collision
    onGround = false;
    if (py >= GROUND_Y - S*2) { py = GROUND_Y - S*2; pvy = 0; onGround = true; }

    // Platform collision
    platforms.forEach(pl => {
      if (px + 28 > pl.x - camX && px < pl.x - camX + pl.w &&
          py + 44 > pl.y && py + 44 < pl.y + 20 && pvy > 0) {
        py = pl.y - 44; pvy = 0; onGround = true;
      }
    });

    // Auto-jump
    jumpT++;
    if (onGround && jumpT > 60) { pvy = -12; jumpT = 0; }

    // Bounce off edges
    if (px > W - 40) { pvx = -2.5; }
    if (px < 10) { pvx = 2.5; }

    // Camera tracks player loosely
    camX = 0;

    // Goomba patrol
    goombaX += goombaDir * 1.2;
    if (goombaX < 300 || goombaX > 420) goombaDir *= -1;

    // BG
    ctx.fillStyle = SKY;
    ctx.fillRect(0, 0, W, H);

    // Clouds (scrolling)
    drawCloud((((t * 0.3) % (W + 100)) - 80), 30);
    drawCloud((((t * 0.2 + 200) % (W + 100)) - 80), 55);

    // Ground
    ctx.fillStyle = GROUND_TOP;
    ctx.fillRect(0, GROUND_Y, W, S);
    ctx.fillStyle = GROUND_FILL;
    ctx.fillRect(0, GROUND_Y + S, W, H - GROUND_Y - S);
    // Ground grid detail
    ctx.strokeStyle = '#7a3818';
    ctx.lineWidth = 1;
    for (let i = 0; i < W; i += S) {
      ctx.beginPath();
      ctx.moveTo(i, GROUND_Y + S); ctx.lineTo(i, H);
      ctx.stroke();
    }

    // Platforms
    platforms.forEach(pl => {
      const bx = pl.x - camX;
      if (pl.type === 'brick') drawBrickBlock(bx, pl.y, pl.w);
      else drawQuestionBlock(bx, pl.y);
    });

    // Coins
    coins.forEach(coin => {
      if (!coin.collected) {
        const bob = Math.sin(t * 0.12) * 4;
        ctx.fillStyle = '#ffe640';
        ctx.fillRect(coin.x - camX + 4, coin.y - 10 + bob, 12, 18);
        ctx.fillStyle = '#cc9900';
        ctx.fillRect(coin.x - camX + 6, coin.y - 6 + bob, 8, 12);
      }
    });

    // Goomba
    drawGoomba(goombaX - camX, GROUND_Y - S*2 - 4);

    // Mario
    drawMario(px, py);

    // HUD
    ctx.fillStyle = '#000';
    ctx.font = '10px monospace';
    ctx.fillStyle = '#fff';
    ctx.fillText('MARIO   WORLD 1-1', 10, 16);
    ctx.fillText('â™¥â™¥â™¥', W - 50, 16);

    requestAnimationFrame(frame);
  }
  frame();
})();

// =====================================================
// PAC-MAN: maze preview
// =====================================================
(function() {
  const c = document.getElementById('cvs-pacman');
  const ctx = c.getContext('2d');
  let t = 0;
  const S = 16; // cell size
  const COLS = Math.floor(c.width / S);
  const ROWS = Math.floor(c.height / S);

  // Mini maze walls (1 = wall, 0 = path)
  const maze = [];
  for (let r = 0; r < ROWS; r++) {
    maze[r] = [];
    for (let col = 0; col < COLS; col++) {
      const edge = r === 0 || r === ROWS-1 || col === 0 || col === COLS-1;
      const inner = (r % 4 === 2 && col > 1 && col < COLS-2 && col % 6 !== 0);
      maze[r][col] = (edge || inner) ? 1 : 0;
    }
  }

  // Pacman
  let pac = {x: 2, y: 2, dx: 1, dy: 0};
  let pacTimer = 0;

  // Ghosts
  const ghosts = [
    {x: 8, y: 4, dx: 1, dy: 0, color: '#ff0000', name: 'Blinky'},
    {x: 6, y: 6, dx: 0, dy: 1, color: '#ffb8ff', name: 'Pinky'},
    {x: 10, y: 4, dx: -1, dy: 0, color: '#00ffff', name: 'Inky'},
    {x: 8, y: 2, dx: 0, dy: -1, color: '#ffb852', name: 'Clyde'},
  ];
  let ghostTimer = 0;

  // Dots
  const dots = {};
  for (let r = 1; r < ROWS-1; r++) {
    for (let col = 1; col < COLS-1; col++) {
      if (!maze[r][col]) dots[`${col},${r}`] = true;
    }
  }

  function canMove(x, y) {
    if (x < 0 || x >= COLS || y < 0 || y >= ROWS) return false;
    return !maze[y][x];
  }

  function moveActor(actor, timer, interval) {
    if (timer % interval !== 0) return;
    const nx = actor.x + actor.dx;
    const ny = actor.y + actor.dy;
    if (canMove(nx, ny)) {
      actor.x = nx; actor.y = ny;
    } else {
      const dirs = [{dx:1,dy:0},{dx:-1,dy:0},{dx:0,dy:1},{dx:0,dy:-1}];
      const valid = dirs.filter(d => canMove(actor.x+d.dx, actor.y+d.dy));
      if (valid.length > 0) {
        const d = valid[Math.floor(Math.random()*valid.length)];
        actor.dx = d.dx; actor.dy = d.dy;
      }
    }
  }

  function drawGhost(gx, gy, color, scared) {
    const px2 = gx * S, py = gy * S;
    const c2 = scared ? '#0000cc' : color;
    // Body
    ctx.fillStyle = c2;
    ctx.fillRect(px2 + 1, py + 4, S - 2, S - 4);
    // Round top
    ctx.beginPath();
    ctx.arc(px2 + S/2, py + 5, S/2 - 1, Math.PI, 0, false);
    ctx.fill();
    // Wavy bottom
    ctx.fillStyle = c2;
    for (let i = 0; i < 3; i++) {
      ctx.fillRect(px2 + 1 + i * 4, py + S - 2, 3, 3);
    }
    // Eyes (blink)
    if (!scared) {
      ctx.fillStyle = '#fff';
      ctx.fillRect(px2 + 3, py + 5, 4, 4);
      ctx.fillRect(px2 + 9, py + 5, 4, 4);
      ctx.fillStyle = '#00f';
      ctx.fillRect(px2 + 4, py + 6, 2, 2);
      ctx.fillRect(px2 + 10, py + 6, 2, 2);
    }
  }

  function frame() {
    t++;
    pacTimer++;
    ghostTimer++;

    moveActor(pac, pacTimer, 8);
    delete dots[`${pac.x},${pac.y}`];
    // Auto-redirect pac if blocked
    const npx = pac.x + pac.dx, npy = pac.y + pac.dy;
    if (!canMove(npx, npy)) {
      const dirs = [{dx:1,dy:0},{dx:-1,dy:0},{dx:0,dy:1},{dx:0,dy:-1}];
      const valid = dirs.filter(d => canMove(pac.x+d.dx, pac.y+d.dy));
      if (valid.length > 0) { const d = valid[Math.floor(Math.random()*valid.length)]; pac.dx = d.dx; pac.dy = d.dy; }
    }
    // Wrap
    if (pac.x < 0) pac.x = COLS-1;
    if (pac.x >= COLS) pac.x = 0;

    ghosts.forEach(g => moveActor(g, ghostTimer, 14));

    // BG
    ctx.fillStyle = '#000011';
    ctx.fillRect(0, 0, c.width, c.height);

    // Maze walls (glowing blue)
    for (let r = 0; r < ROWS; r++) {
      for (let col = 0; col < COLS; col++) {
        if (maze[r][col]) {
          ctx.fillStyle = '#0000aa';
          ctx.fillRect(col*S, r*S, S, S);
          ctx.strokeStyle = '#4444ff';
          ctx.lineWidth = 1;
          ctx.strokeRect(col*S+1, r*S+1, S-2, S-2);
        }
      }
    }

    // Dots
    ctx.fillStyle = '#ffeeaa';
    for (const key in dots) {
      const [dx2, dy2] = key.split(',').map(Number);
      ctx.fillRect(dx2*S + S/2 - 2, dy2*S + S/2 - 2, 4, 4);
    }
    // Power pellets (corners)
    const pp = [[2,2],[COLS-3,2],[2,ROWS-3],[COLS-3,ROWS-3]];
    pp.forEach(([px3, py3]) => {
      const pulse = Math.sin(t*0.15) * 2 + 6;
      ctx.fillStyle = '#ffe640';
      ctx.shadowColor = '#ffcc00';
      ctx.shadowBlur = 8;
      ctx.beginPath();
      ctx.arc(px3*S + S/2, py3*S + S/2, pulse, 0, Math.PI*2);
      ctx.fill();
      ctx.shadowBlur = 0;
    });

    // Ghosts
    ghosts.forEach(g => drawGhost(g.x, g.y, g.color, false));

    // Pac-Man
    const mouthAngle = Math.abs(Math.sin(t * 0.2)) * 0.4;
    ctx.fillStyle = '#ffe600';
    ctx.shadowColor = '#ffe600';
    ctx.shadowBlur = 10;
    ctx.beginPath();
    const angle = Math.atan2(pac.dy, pac.dx);
    ctx.moveTo(pac.x*S + S/2, pac.y*S + S/2);
    ctx.arc(pac.x*S + S/2, pac.y*S + S/2, S/2 - 1,
      angle + mouthAngle, angle + Math.PI*2 - mouthAngle, false);
    ctx.closePath();
    ctx.fill();
    ctx.shadowBlur = 0;

    // Score overlay
    ctx.fillStyle = '#ffe640';
    ctx.font = '10px monospace';
    ctx.fillText(`DOTS: ${Object.keys(dots).length}`, 8, c.height - 6);

    requestAnimationFrame(frame);
  }
  frame();
})();

// =====================================================
// DRIVE MAD: car physics preview
// =====================================================
(function() {
  const c = document.getElementById('cvs-drivemad');
  const ctx = c.getContext('2d');
  let t = 0;
  const W = c.width, H = c.height;

  // Terrain path
  const TERRAIN_PTS = [];
  const SEG = 30;
  for (let i = 0; i <= Math.ceil(W/SEG)+5; i++) {
    const x = i * SEG;
    const y = H*0.65 + Math.sin(i*0.7)*30 + Math.cos(i*0.4)*20;
    TERRAIN_PTS.push({x, y});
  }

  // Car state
  let carX = 80, carY = H*0.5;
  let carVX = 2, carVY = 0;
  let carAngle = 0, carAngV = 0;
  let scrollX = 0;

  // Coins on track
  const trackCoins = [{ox: 200, y: H*0.5-30, collected: false}, {ox: 400, y: H*0.45-30, collected: false}];

  function getTerrainY(wx) {
    const idx = Math.floor(wx / SEG);
    if (idx < 0 || idx >= TERRAIN_PTS.length-1) return H*0.65;
    const t2 = (wx % SEG) / SEG;
    return TERRAIN_PTS[idx].y * (1-t2) + TERRAIN_PTS[idx+1].y * t2;
  }
  function getTerrainAngle(wx) {
    const y1 = getTerrainY(wx), y2 = getTerrainY(wx+5);
    return Math.atan2(y2-y1, 5);
  }

  function drawCar(cx, cy, angle) {
    ctx.save();
    ctx.translate(cx, cy);
    ctx.rotate(angle);
    // Body
    ctx.fillStyle = '#c800ff';
    ctx.fillRect(-28, -14, 56, 22);
    // Roof
    ctx.fillStyle = '#9900cc';
    ctx.fillRect(-18, -26, 36, 14);
    // Windows
    ctx.fillStyle = '#aaeeff';
    ctx.fillRect(-14, -24, 12, 10);
    ctx.fillRect(2, -24, 12, 10);
    // Wheels
    ctx.fillStyle = '#222';
    ctx.beginPath(); ctx.arc(-18, 8, 8, 0, Math.PI*2); ctx.fill();
    ctx.beginPath(); ctx.arc(18, 8, 8, 0, Math.PI*2); ctx.fill();
    ctx.fillStyle = '#888';
    ctx.beginPath(); ctx.arc(-18, 8, 4, 0, Math.PI*2); ctx.fill();
    ctx.beginPath(); ctx.arc(18, 8, 4, 0, Math.PI*2); ctx.fill();
    // Exhaust smoke puff
    if (t % 20 < 10) {
      ctx.fillStyle = 'rgba(150,150,150,0.5)';
      ctx.fillRect(-32, -2, 8, 8);
    }
    ctx.restore();
  }

  function drawTerrain(scroll) {
    // Sky
    const sky = ctx.createLinearGradient(0,0,0,H);
    sky.addColorStop(0, '#1a0040');
    sky.addColorStop(1, '#2a0060');
    ctx.fillStyle = sky;
    ctx.fillRect(0,0,W,H);

    // Stars
    ctx.fillStyle = '#fff';
    for (let i = 0; i < 20; i++) {
      const sx = ((i * 73 + scroll * 0.1) % W + W) % W;
      const sy = (i * 37) % (H*0.55);
      ctx.fillRect(sx, sy, 2, 2);
    }

    // Draw terrain polygon
    ctx.beginPath();
    ctx.moveTo(0, H);
    for (let i = 0; i <= Math.ceil(W/SEG)+2; i++) {
      const wx = i * SEG + (scroll % SEG) - SEG;
      const worldX = wx + scroll - (scroll % SEG) + SEG;
      const gy = getTerrainY(worldX);
      ctx.lineTo(wx, gy);
    }
    ctx.lineTo(W, H);
    ctx.closePath();
    const tGrad = ctx.createLinearGradient(0, H*0.5, 0, H);
    tGrad.addColorStop(0, '#2a1060');
    tGrad.addColorStop(0.3, '#3a1880');
    tGrad.addColorStop(1, '#1a0840');
    ctx.fillStyle = tGrad;
    ctx.fill();

    // Terrain surface line with glow
    ctx.strokeStyle = '#c800ff';
    ctx.lineWidth = 3;
    ctx.shadowColor = '#c800ff';
    ctx.shadowBlur = 10;
    ctx.beginPath();
    for (let i = 0; i <= Math.ceil(W/SEG)+2; i++) {
      const wx = i * SEG + (scroll % SEG) - SEG;
      const worldX = wx + scroll - (scroll % SEG) + SEG;
      const gy = getTerrainY(worldX);
      if (i===0) ctx.moveTo(wx, gy);
      else ctx.lineTo(wx, gy);
    }
    ctx.stroke();
    ctx.shadowBlur = 0;

    // Trees/obstacles
    for (let i = 0; i < 5; i++) {
      const wx = ((i * 120 - scroll * 0.5) % (W + 60) + W + 60) % (W + 60) - 30;
      const worldX = wx + scroll * 0.5;
      const gy = getTerrainY(worldX + scroll * 0.5);
      ctx.fillStyle = '#1a6a10';
      ctx.beginPath();
      ctx.moveTo(wx, gy - 50);
      ctx.lineTo(wx - 20, gy);
      ctx.lineTo(wx + 20, gy);
      ctx.closePath();
      ctx.fill();
      ctx.fillStyle = '#5a3010';
      ctx.fillRect(wx - 4, gy, 8, 20);
    }
  }

  function frame() {
    t++;

    // Physics
    const groundY = getTerrainY(carX + scrollX);
    const targetAngle = getTerrainAngle(carX + scrollX);
    carVX = 2.5;
    carVY += 0.4;
    carX += carVX;
    carY += carVY;

    if (carY >= groundY - 14) {
      carY = groundY - 14;
      carVY = 0;
      carAngV *= 0.8;
    }
    carAngle += (targetAngle - carAngle) * 0.15;

    // Scroll
    if (carX > W * 0.4) { scrollX += carVX; carX -= carVX; }
    if (carX < 0) carX = 0;

    drawTerrain(scrollX);

    // Collect coins
    trackCoins.forEach(coin => {
      if (!coin.collected) {
        const cx2 = coin.ox - scrollX;
        if (Math.abs(cx2 - carX) < 30 && Math.abs(coin.y - carY) < 30) coin.collected = true;
        if (cx2 > -10 && cx2 < W + 10) {
          ctx.fillStyle = '#ffe640';
          ctx.shadowColor = '#ffe640';
          ctx.shadowBlur = 6;
          ctx.beginPath();
          ctx.arc(cx2, coin.y, 8, 0, Math.PI*2);
          ctx.fill();
          ctx.shadowBlur = 0;
        }
      }
    });

    drawCar(carX, carY, carAngle);

    // Speed lines effect
    for (let i = 0; i < 5; i++) {
      const lx = ((i * 80 + W - (t * 5) % W) % W);
      ctx.strokeStyle = 'rgba(200,0,255,0.1)';
      ctx.lineWidth = 1;
      ctx.beginPath();
      ctx.moveTo(lx, 0); ctx.lineTo(lx - 20, H);
      ctx.stroke();
    }

    // HUD
    const speed = Math.floor(carVX * 40);
    ctx.fillStyle = '#c800ff';
    ctx.font = '10px monospace';
    ctx.fillText(`SPEED: ${speed} KPH`, 8, 18);

    requestAnimationFrame(frame);
  }
  frame();
})();
</script>
</body>
</html>
